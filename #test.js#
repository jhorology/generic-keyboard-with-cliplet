
this.load('node_modules/bitbone/node_modules/underscore/underscore.js');
this.load('node_modules/bitbone/node_modules/backbone/backbone.js');
(function(root, Backbone, _) {
    'use strict';


    var Channel = Backbone.Model.extend({
        // Initialize backbone model.
        initialize: function(attributes, options, channel) {

            this.initChannel(attributes, options, channel);
            this.api = channel;
            this.initialized = true;
        },

        initChannel: function(attributes, options, channel) {
            var context = this,
                api = channel;
            root.println('##### initChannel() api' + api);
        },
        print: function() {
            root.println('##### print() api' + this.api);
        }

    }, {
        create: function(channel, options) {
            return new Channel(undefined, options, channel);
        }

    });

    var Track = Channel.extend({

        initialize: function(attributes, options, track) {
            this.initTrack(attributes, options, track);
            this.api = track;
            this.initialized = true;
        },
        initTrack: function(attributes, options, api) {
            var context = this;
            this.initChannel(attributes, options, api);
            root.println('##### initTrack() api' + api);
        }

    }, {

        // factrory method
        create: function(track, options) {
            return new Track(undefined, options, track);
        }

    });

    var TrackCollection = Backbone.Collection.extend({
        model: Track
    });

    var TrackCollection = Backbone.Collection.extend({
        model: Track
    });


    var c = new TrackCollection();
    c.add(Track.create('hogehoge 1'));
    c.add(Track.create('hogehoge 2'));
    c.add(Track.create('hogehoge 3'));
    c.add(Track.create('hogehoge 4'));

    c.each(function(track) {
        track.print();
    });

}(this,  Backbone, _));

